{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\a851272\\\\OneDrive - Atos\\\\Bureau\\\\KPI-Jira-Front-End-master\\\\src\\\\App\\\\components\\\\ExportExcel.js\";\nimport React from 'react';\nimport moment from 'moment';\nimport * as FileSaver from 'file-saver';\nimport * as XLSX from 'xlsx';\nimport { Button } from 'react-bootstrap';\nimport columns from './SprintData';\nexport var ExportExcel = function ExportExcel(_ref) {\n  var csvData = _ref.csvData,\n      fileName = _ref.fileName,\n      propColumns = _ref.propColumns;\n  var fileType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\n  var fileExtension = '.xlsx';\n  if (propColumns) columns = propColumns;\n  csvData = formatJson(csvData);\n  console.log(csvData);\n\n  var exportToCSV = function exportToCSV(csvData, fileName) {\n    var ws = XLSX.utils.json_to_sheet(csvData);\n    console.log('ws', ws);\n    var wb = {\n      Sheets: {\n        'data': ws\n      },\n      SheetNames: ['data']\n    };\n    var excelBuffer = XLSX.write(wb, {\n      bookType: 'xlsx',\n      type: 'array'\n    });\n    var data = new Blob([excelBuffer], {\n      type: fileType\n    });\n    FileSaver.saveAs(data, fileName + fileExtension);\n  };\n\n  return React.createElement(Button, {\n    variant: \"success\",\n    onClick: function onClick(e) {\n      return exportToCSV(csvData, fileName);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"feather icon-external-link  mx-0 \",\n    style: {\n      fontSize: \"25px \"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28\n    },\n    __self: this\n  }), \" \", React.createElement(\"span\", {\n    className: \"font-weight-bold\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28\n    },\n    __self: this\n  }, \"Excel\"));\n}; ///convert data/////\n\nvar ExcelDateToJSDate = function ExcelDateToJSDate(date) {\n  var converted_date = new Date(Math.round((date - 25569) * 864e5));\n  converted_date = String(converted_date).slice(4, 15);\n  date = converted_date.split(\" \");\n  var day = date[1];\n  var month = date[0];\n  month = \"JanFebMarAprMayJunJulAugSepOctNovDec\".indexOf(month) / 3 + 1;\n  if (month.toString().length <= 1) month = '0' + month;\n  var year = date[2];\n  return String(day + '-' + month + '-' + year.slice(2, 4));\n}; // Conversion of raw json data to excel kpi file like data format\n\n\nvar formatJson = function formatJson(csvData) {\n  return csvData.map(function (sprint) {\n    var data = {};\n    if (sprint.projectName) data['Plateau'] = sprint.projectName;\n    data['fin'] = ExcelDateToJSDate(sprint.fin);\n    columns.forEach(function (_ref2) {\n      var title = _ref2.title,\n          dataIndex = _ref2.dataIndex;\n      data[title] = sprint[dataIndex];\n    });\n    return data;\n  });\n}; // {\n//     title: 'Plateau',\n//     dataIndex: 'projectName',\n// },","map":{"version":3,"sources":["C:\\Users\\a851272\\OneDrive - Atos\\Bureau\\KPI-Jira-Front-End-master\\src\\App\\components\\ExportExcel.js"],"names":["React","moment","FileSaver","XLSX","Button","columns","ExportExcel","csvData","fileName","propColumns","fileType","fileExtension","formatJson","console","log","exportToCSV","ws","utils","json_to_sheet","wb","Sheets","SheetNames","excelBuffer","write","bookType","type","data","Blob","saveAs","e","fontSize","ExcelDateToJSDate","date","converted_date","Date","Math","round","String","slice","split","day","month","indexOf","toString","length","year","map","sprint","projectName","fin","forEach","title","dataIndex"],"mappings":"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","sourcesContent":["import React from 'react'\nimport moment from 'moment'\nimport * as FileSaver from 'file-saver';\nimport * as XLSX from 'xlsx';\nimport { Button } from 'react-bootstrap';\nimport columns from './SprintData';\n\nexport const ExportExcel = ({ csvData, fileName, propColumns }) => {\n    const fileType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\n    const fileExtension = '.xlsx';\n\n    if (propColumns)\n        columns = propColumns\n\n    csvData = formatJson(csvData)\n    console.log(csvData);\n    const exportToCSV = (csvData, fileName) => {\n        const ws = XLSX.utils.json_to_sheet(csvData);\n        console.log('ws', ws)\n        const wb = { Sheets: { 'data': ws }, SheetNames: ['data'] };\n        const excelBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });\n        const data = new Blob([excelBuffer], { type: fileType });\n        FileSaver.saveAs(data, fileName + fileExtension);\n    }\n\n    return (\n        <Button variant=\"success\" onClick={(e) => exportToCSV(csvData, fileName)}>\n            <i className=\"feather icon-external-link  mx-0 \" style={{ fontSize: \"25px \" }}></i> <span className=\"font-weight-bold\">Excel</span></Button>\n    )\n}\n///convert data/////\nconst ExcelDateToJSDate = (date) => {\n    let converted_date = new Date(Math.round((date - 25569) * 864e5));\n    converted_date = String(converted_date).slice(4, 15)\n    date = converted_date.split(\" \")\n    let day = date[1];\n    let month = date[0];\n    month = \"JanFebMarAprMayJunJulAugSepOctNovDec\".indexOf(month) / 3 + 1\n    if (month.toString().length <= 1)\n        month = '0' + month\n    let year = date[2];\n    return String(day + '-' + month + '-' + year.slice(2, 4))\n}\n\n// Conversion of raw json data to excel kpi file like data format\nconst formatJson = (csvData) => (\n    csvData.map((sprint) => {\n        const data = {}\n        if (sprint.projectName)\n            data['Plateau'] = sprint.projectName \n            data['fin']=ExcelDateToJSDate(sprint.fin);\n        columns.forEach(({ title, dataIndex }) => {\n            data[title] = sprint[dataIndex]\n        })\n        return data\n    })\n)\n\n// {\n//     title: 'Plateau',\n//     dataIndex: 'projectName',\n// },"]},"metadata":{},"sourceType":"module"}